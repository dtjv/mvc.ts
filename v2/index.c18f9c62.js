var t,e,s=t=function(t,e){var s="000000000"+t;return s.substr(s.length-e)},i="object"==typeof window?window:self,o=Object.keys(i).length,n=s(((navigator.mimeTypes?navigator.mimeTypes.length:0)+navigator.userAgent.length).toString(36)+o.toString(36),4),r=function(){return n},h=t,d="undefined"!=typeof window&&(window.crypto||window.msCrypto)||"undefined"!=typeof self&&self.crypto;if(d){var a=Math.pow(2,32)-1;e=function(){return Math.abs(d.getRandomValues(new Uint32Array(1))[0]/a)}}else e=Math.random;var c=e,l=0,u=Math.pow(36,4);function _(){return h((c()*u<<0).toString(36),4)}function p(){return l=l<u?l:0,++l-1}function g(){return"c"+(new Date).getTime().toString(36)+h(p().toString(36),4)+r()+(_()+_())}g.slug=function(){var t=(new Date).getTime().toString(36),e=p().toString(36).slice(-4),s=r().slice(0,1)+r().slice(-1),i=_().slice(-2);return t.slice(-2)+e+s+i},g.isCuid=function(t){return"string"==typeof t&&!!t.startsWith("c")},g.isSlug=function(t){if("string"!=typeof t)return!1;var e=t.length;return e>=7&&e<=10},g.fingerprint=r;var m,f,k=(m=g)&&m.__esModule?m.default:m;class ${constructor(){this._listeners=new Map}addListener(t,e){const s=this._listeners.get(t)??[];s.push(e),this._listeners.set(t,s)}emit(t){(this._listeners.get(t)??[]).forEach((t=>{t()}))}}(f||(f={})).CHANGE="CHANGE";class w extends ${constructor(t){if(super(),!t.task)throw new Error("No task value. 'task' is required. Constructor failed.");this.id=t.id??k(),this._task=t.task,this._done=t.done??!1}get task(){return this._task}get done(){return this._done}toggle(){this._done=!this._done,this.emit(f.CHANGE)}update(t){if(!t)throw new Error("No task value. 'task' is required. Update failed.");this._task!==t&&(this._task=t,this.emit(f.CHANGE))}toJSON(){return{id:this.id,task:this._task,done:this._done}}}const v=new class{constructor(t,e){this._key=t,this._db=e}get(){return JSON.parse(this._db.getItem(this._key)??"[]")}set(t){this._db.setItem(this._key,JSON.stringify(t))}}("todos2",localStorage),E=new class extends ${constructor(){super(...arguments),this._todos=[]}get todos(){return this._todos.slice(0)}size(){return this._todos.length}insert(t){t.addListener(f.CHANGE,this._onChange.bind(this)),this._todos.push(t),this._onChange()}remove(t){if(!t)throw new Error("No id value. 'id' is required. Remove failed.");this._todos=this._todos.filter((e=>e.id!==t)),this._onChange()}toJSON(){return this._todos.map((t=>t.toJSON()))}_onChange(){this.emit(f.CHANGE)}},T=new class{constructor(t,e,s){if(this.document=t,this.todos=s,this._txtCache="",this.$root=this.document.querySelector(e),!this.$root)throw new Error(`root id, '${e}', must exist in doc`);this.$wrapper=this._createElement("div","wrapper"),this.$header=this._createElement("header"),this.$title=this._createElement("h1"),this.$title.textContent="Todos",this.$version=this._createElement("span","version"),this.$version.textContent="v2",this.$task=this._createElement("div","flex justify-between"),this.$taskTxt=this._createElement("input","task-txt"),this.$taskTxt.setAttribute("type","text"),this.$taskTxt.setAttribute("placeholder","Enter your task"),this.$taskBtn=this._createElement("button","task-btn"),this.$taskBtn.textContent="Add Task",this.$todos=this._createElement("ul","space-y-4"),this.$noTodos=this._createElement("p","hidden font-bold text-gray-500"),this.$noTodos.textContent="No tasks for you!",this.$header.append(this.$title,this.$version),this.$task.append(this.$taskTxt,this.$taskBtn),this.$wrapper.append(this.$header,this.$task,this.$todos,this.$noTodos),this.$root.append(this.$wrapper),this.$taskBtn.addEventListener("click",this._createTodo.bind(this)),this.$todos.addEventListener("change",this._toggleTodo.bind(this)),this.$todos.addEventListener("click",this._removeTodo.bind(this)),this.$todos.addEventListener("focusin",this._cacheTodoTxt.bind(this)),this.$todos.addEventListener("focusout",this._updateTodo.bind(this))}render(){for(;this.$todos.firstChild;)this.$todos.firstChild.remove();0===this.todos.size()?this.$noTodos.classList.remove("hidden"):(this.$noTodos.classList.add("hidden"),this.$todos.append(...this.todos.todos.map((t=>this._createItem(t)))))}_searchTodo(t){return t?this.todos.todos.find((e=>e.id===t)):void 0}_createTodo(){const t=new w({task:this.$taskTxt.value});this.todos.insert(t),this.$taskTxt.value=""}_toggleTodo(t){const e=t.target;if(e.classList.contains("todo-chk")){this._searchTodo(e.parentElement?.id??"")?.toggle?.()}}_cacheTodoTxt(t){const e=t.target;e?.classList?.contains?.("todo-txt")&&(this._txtCache=e.textContent)}_updateTodo(t){const e=t.target;if(e.classList.contains("todo-txt")){this._searchTodo(e.parentElement?.id??"")?.update?.(e.textContent?e.textContent:this._txtCache),this._txtCache=""}}_removeTodo(t){const e=t.target;if(e.classList.contains("todo-btn")){const t=this._searchTodo(e.parentElement?.id??"");t&&this.todos.remove(t.id)}}_createElement(t,e){const s=this.document.createElement(t);return e&&s.classList.add(...e.split(" ")),s}_createItem(t){const e=this._createElement("li","todo");e.setAttribute("id",t.id);const s=this._createElement("input","todo-chk");s.setAttribute("type","checkbox"),t.done&&s.setAttribute("checked","");const i=this._createElement("span","todo-txt");i.setAttribute("contentEditable","");const o=this.document.createTextNode(t.task);if(t.done){const t=this._createElement("s");t.append(o),i.append(t)}else i.append(o);const n=this._createElement("button","todo-btn");return n.textContent="Delete",e.append(s,i,n),e}}(window.document,"#app",E);new class{constructor(t,e,s){this._todos=t,this._view=e,this._store=s,this.load(),this._todos.addListener(f.CHANGE,this._onChange.bind(this))}load(){this._store.get().forEach((t=>{this._todos.insert(new w(t))}))}show(){this._view.render()}_save(){this._store.set(this._todos.toJSON())}_onChange(){this._save(),this.show()}}(E,T,v).show();
//# sourceMappingURL=index.c18f9c62.js.map
