var t,e,s=t=function(t,e){var s="000000000"+t;return s.substr(s.length-e)},i="object"==typeof window?window:self,o=Object.keys(i).length,n=s(((navigator.mimeTypes?navigator.mimeTypes.length:0)+navigator.userAgent.length).toString(36)+o.toString(36),4),r=function(){return n},h=t,d="undefined"!=typeof window&&(window.crypto||window.msCrypto)||"undefined"!=typeof self&&self.crypto;if(d){var a=Math.pow(2,32)-1;e=function(){return Math.abs(d.getRandomValues(new Uint32Array(1))[0]/a)}}else e=Math.random;var c=e,l=0,u=Math.pow(36,4);function p(){return h((c()*u<<0).toString(36),4)}function g(){return l=l<u?l:0,++l-1}function m(){return"c"+(new Date).getTime().toString(36)+h(g().toString(36),4)+r()+(p()+p())}m.slug=function(){var t=(new Date).getTime().toString(36),e=g().toString(36).slice(-4),s=r().slice(0,1)+r().slice(-1),i=p().slice(-2);return t.slice(-2)+e+s+i},m.isCuid=function(t){return"string"==typeof t&&!!t.startsWith("c")},m.isSlug=function(t){if("string"!=typeof t)return!1;var e=t.length;return e>=7&&e<=10},m.fingerprint=r;var f,k,$=(f=m)&&f.__esModule?f.default:f;class w{constructor(){this.listeners=new Map}addListener(t,e){const s=this.listeners.get(t)??[];s.push(e),this.listeners.set(t,s)}emit(t){(this.listeners.get(t)??[]).forEach((t=>{t()}))}}(k||(k={})).CHANGE="CHANGE";class v extends w{constructor(t){if(super(),!t.task)throw new Error("No task value. 'task' is required. Constructor failed.");this.id=t.id??$(),this._task=t.task,this._done=t.done??!1}get task(){return this._task}get done(){return this._done}toggle(){this._done=!this._done,this.emit(k.CHANGE)}update(t){if(!t)throw new Error("No task value. 'task' is required. Update failed.");this._task!==t&&(this._task=t,this.emit(k.CHANGE))}toJSON(){return{id:this.id,task:this._task,done:this._done}}}const E=new class{constructor(t,e){this.key=t,this.db=e}get(){return JSON.parse(this.db.getItem(this.key)??"[]")}set(t){this.db.setItem(this.key,JSON.stringify(t))}}("todos2",localStorage),_=new class extends w{constructor(){super(...arguments),this._todos=[]}get todos(){return this._todos.slice(0)}size(){return this._todos.length}insert(t){t.addListener(k.CHANGE,this._onChange.bind(this)),this._todos.push(t),this._onChange()}remove(t){if(!t)throw new Error("No id value. 'id' is required. Remove failed.");this._todos=this._todos.filter((e=>e.id!==t)),this._onChange()}toJSON(){return this._todos.map((t=>t.toJSON()))}_onChange(){this.emit(k.CHANGE)}},T=new class{constructor(t,e,s){if(this.document=t,this.todos=s,this.txtCache="",this.$root=this.document.querySelector(e),!this.$root)throw new Error(`root id, '${e}', must exist in doc`);this.$wrapper=this.createElement("div","wrapper"),this.$header=this.createElement("header"),this.$title=this.createElement("h1"),this.$title.textContent="Todos",this.$version=this.createElement("span","version"),this.$version.textContent="v2",this.$task=this.createElement("div","flex justify-between"),this.$taskTxt=this.createElement("input","task-txt"),this.$taskTxt.setAttribute("type","text"),this.$taskTxt.setAttribute("placeholder","Enter your task"),this.$taskBtn=this.createElement("button","task-btn"),this.$taskBtn.textContent="Add Task",this.$todos=this.createElement("ul","space-y-4"),this.$noTodos=this.createElement("p","hidden font-bold text-gray-500"),this.$noTodos.textContent="No tasks for you!",this.$header.append(this.$title,this.$version),this.$task.append(this.$taskTxt,this.$taskBtn),this.$wrapper.append(this.$header,this.$task,this.$todos,this.$noTodos),this.$root.append(this.$wrapper),this.$taskBtn.addEventListener("click",this.createTodo.bind(this)),this.$todos.addEventListener("change",this.toggleTodo.bind(this)),this.$todos.addEventListener("click",this.removeTodo.bind(this)),this.$todos.addEventListener("focusin",this.cacheTodoTxt.bind(this)),this.$todos.addEventListener("focusout",this.updateTodo.bind(this))}render(){for(;this.$todos.firstChild;)this.$todos.firstChild.remove();0===this.todos.size()?this.$noTodos.classList.remove("hidden"):(this.$noTodos.classList.add("hidden"),this.$todos.append(...this.todos.todos.map((t=>this.createItem(t)))))}searchTodo(t){return t?this.todos.todos.find((e=>e.id===t)):void 0}createTodo(){const t=new v({task:this.$taskTxt.value});this.todos.insert(t),this.$taskTxt.value=""}toggleTodo(t){const e=t.target;if(e.classList.contains("todo-chk")){this.searchTodo(e.parentElement?.id??"")?.toggle?.()}}cacheTodoTxt(t){const e=t.target;e?.classList?.contains?.("todo-txt")&&(this.txtCache=e.textContent)}updateTodo(t){const e=t.target;if(e.classList.contains("todo-txt")){this.searchTodo(e.parentElement?.id??"")?.update?.(e.textContent?e.textContent:this.txtCache),this.txtCache=""}}removeTodo(t){const e=t.target;if(e.classList.contains("todo-btn")){const t=this.searchTodo(e.parentElement?.id??"");t&&this.todos.remove(t.id)}}createElement(t,e){const s=this.document.createElement(t);return e&&s.classList.add(...e.split(" ")),s}createItem(t){const e=this.createElement("li","todo");e.setAttribute("id",t.id);const s=this.createElement("input","todo-chk");s.setAttribute("type","checkbox"),t.done&&s.setAttribute("checked","");const i=this.createElement("span","todo-txt");i.setAttribute("contentEditable","");const o=this.document.createTextNode(t.task);if(t.done){const t=this.createElement("s");t.append(o),i.append(t)}else i.append(o);const n=this.createElement("button","todo-btn");return n.textContent="Delete",e.append(s,i,n),e}}(window.document,"#app",_);new class{constructor(t,e,s){this._todos=t,this._view=e,this._store=s,this.load(),this._todos.addListener(k.CHANGE,this._onChange.bind(this))}load(){this._store.get().forEach((t=>{this._todos.insert(new v(t))}))}show(){this._view.render()}_save(){this._store.set(this._todos.toJSON())}_onChange(){this._save(),this.show()}}(_,T,E).show();
//# sourceMappingURL=index.d2c46d35.js.map
