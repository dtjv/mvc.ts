var t,e;(e=t||(t={})).CREATE_TODO="CREATE_TODO",e.UPDATE_TODO="UPDATE_TODO",e.REMOVE_TODO="REMOVE_TODO";var s,i,o=s=function(t,e){var s="000000000"+t;return s.substr(s.length-e)},n="object"==typeof window?window:self,d=Object.keys(n).length,r=o(((navigator.mimeTypes?navigator.mimeTypes.length:0)+navigator.userAgent.length).toString(36)+d.toString(36),4),a=function(){return r},h=s,c="undefined"!=typeof window&&(window.crypto||window.msCrypto)||"undefined"!=typeof self&&self.crypto;if(c){var l=Math.pow(2,32)-1;i=function(){return Math.abs(c.getRandomValues(new Uint32Array(1))[0]/l)}}else i=Math.random;var _=i,u=0,p=Math.pow(36,4);function T(){return h((_()*p<<0).toString(36),4)}function E(){return u=u<p?u:0,++u-1}function m(){return"c"+(new Date).getTime().toString(36)+h(E().toString(36),4)+a()+(T()+T())}m.slug=function(){var t=(new Date).getTime().toString(36),e=E().toString(36).slice(-4),s=a().slice(0,1)+a().slice(-1),i=T().slice(-2);return t.slice(-2)+e+s+i},m.isCuid=function(t){return"string"==typeof t&&!!t.startsWith("c")},m.isSlug=function(t){if("string"!=typeof t)return!1;var e=t.length;return e>=7&&e<=10},m.fingerprint=a;var g,v=(g=m)&&g.__esModule?g.default:g;const w=new class{constructor(t,e){if(this.document=t,this.handlers=new Map,this.txtCache="",this.$root=this.document.querySelector(e),!this.$root)throw new Error(`root id, '${e}', must exist in doc`);this.$wrapper=this._createElement("div","wrapper"),this.$header=this._createElement("header"),this.$title=this._createElement("h1"),this.$title.textContent="Todos",this.$version=this._createElement("span","version"),this.$version.textContent="v1",this.$task=this._createElement("div","flex justify-between"),this.$taskTxt=this._createElement("input","task-txt"),this.$taskTxt.setAttribute("type","text"),this.$taskTxt.setAttribute("placeholder","Enter your task"),this.$taskBtn=this._createElement("button","task-btn"),this.$taskBtn.textContent="Add Task",this.$todos=this._createElement("ul","space-y-4"),this.$noTodos=this._createElement("p","hidden font-bold text-gray-500"),this.$noTodos.textContent="No tasks for you!",this.$header.append(this.$title,this.$version),this.$task.append(this.$taskTxt,this.$taskBtn),this.$wrapper.append(this.$header,this.$task,this.$todos,this.$noTodos),this.$root.append(this.$wrapper),this.$taskBtn.addEventListener("click",this._createTodo.bind(this)),this.$todos.addEventListener("change",this._toggleTodo.bind(this)),this.$todos.addEventListener("click",this._removeTodo.bind(this)),this.$todos.addEventListener("focusin",this._cacheTodoTxt.bind(this)),this.$todos.addEventListener("focusout",this._updateTodo.bind(this))}registerHandler({event:t,handler:e}){this.handlers.set(t,e)}render(t){for(;this.$todos.firstChild;)this.$todos.firstChild.remove();0===t.length?this.$noTodos.classList.remove("hidden"):(this.$noTodos.classList.add("hidden"),this.$todos.append(...t.map((t=>this._createItem(t)))))}_createTodo(){this.handlers.get(t.CREATE_TODO)?.({task:this.$taskTxt.value}),this.$taskTxt.value=""}_toggleTodo(e){const s=e.target;s.classList.contains("todo-chk")&&this.handlers.get(t.UPDATE_TODO)?.({id:s.parentElement?.id,done:s.checked})}_cacheTodoTxt(t){const e=t.target;e?.classList?.contains?.("todo-txt")&&(this.txtCache=e.textContent)}_updateTodo(e){const s=e.target;s.classList.contains("todo-txt")&&(this.handlers.get(t.UPDATE_TODO)?.({id:s.parentElement?.id,task:s.textContent?s.textContent:this.txtCache}),this.txtCache="")}_removeTodo(e){const s=e.target;s.classList.contains("todo-btn")&&this.handlers.get(t.REMOVE_TODO)?.({id:s.parentElement?.id})}_createElement(t,e){const s=this.document.createElement(t);return e&&s.classList.add(...e.split(" ")),s}_createItem(t){const e=this._createElement("li","todo");e.setAttribute("id",t.id);const s=this._createElement("input","todo-chk");s.setAttribute("type","checkbox"),t.done&&s.setAttribute("checked","");const i=this._createElement("span","todo-txt");i.setAttribute("contentEditable","");const o=this.document.createTextNode(t.task);if(t.done){const t=this._createElement("s");t.append(o),i.append(t)}else i.append(o);const n=this._createElement("button","todo-btn");return n.textContent="Delete",e.append(s,i,n),e}}(window.document,"#app"),f=new class{constructor(){this._todos=[]}insert(t){if(!t.task)throw new Error("No task. Todo 'task' is required. Insert failed.");const e={id:t.id??v(),task:t.task,done:t.done??!1};this._todos.push(e)}update(t){if(!t.id)throw new Error("No id. Todo 'id' is required. Update failed.");this._todos=this._todos.map((e=>e.id===t.id?{id:e.id,task:t.task??e.task,done:t.done??e.done}:e))}remove(t){if(!t)throw new Error("No id. Todo 'id' is required. Remove failed.");this._todos=this._todos.filter((e=>e.id!==t))}toJSON(){return this._todos}},k=new class{constructor(t,e){this.key=t,this.db=e}get(){return JSON.parse(this.db.getItem(this.key)??"[]")}set(t){this.db.setItem(this.key,JSON.stringify(t))}}("todos1",localStorage);new class{constructor(e,s,i){this._todos=e,this._view=s,this._store=i,this._load(),this._view.registerHandler({event:t.CREATE_TODO,handler:this._handleCreateTodo.bind(this)}),this._view.registerHandler({event:t.UPDATE_TODO,handler:this._handleUpdateTodo.bind(this)}),this._view.registerHandler({event:t.REMOVE_TODO,handler:this._handleRemoveTodo.bind(this)})}show(){this._view.render(this._todos.toJSON())}_load(){this._store.get().forEach((t=>{this._todos.insert(t)}))}_save(){this._store.set(this._todos.toJSON())}_handleCreateTodo(t){t.task&&(this._todos.insert({task:t.task}),this._save(),this.show())}_handleUpdateTodo(t){t.id&&(this._todos.update({...t,id:t.id}),this._save(),this.show())}_handleRemoveTodo(t){t.id&&(this._todos.remove(t.id),this._save(),this.show())}}(f,w,k).show();
//# sourceMappingURL=index.dc454b7d.js.map
